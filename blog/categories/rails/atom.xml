<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: rails | さよならインターネット]]></title>
  <link href="http://blog.kenjiskywalker.org/blog/categories/rails/atom.xml" rel="self"/>
  <link href="http://blog.kenjiskywalker.org/"/>
  <updated>2015-08-22T14:04:09+09:00</updated>
  <id>http://blog.kenjiskywalker.org/</id>
  <author>
    <name><![CDATA[kenjiskywalker]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[RailsのARで取ってきたオブジェクトにアクセスする]]></title>
    <link href="http://blog.kenjiskywalker.org/blog/2015/08/08/access-element-in-rails-controller-object/"/>
    <updated>2015-08-08T20:57:00+09:00</updated>
    <id>http://blog.kenjiskywalker.org/blog/2015/08/08/access-element-in-rails-controller-object</id>
    <content type="html"><![CDATA[<p>考えたら当たり前なんだけど</p>

<pre><code>mysql&gt; desc people;
+---------------+--------------+------+-----+---------+----------------+
| Field         | Type         | Null | Key | Default | Extra          |
+---------------+--------------+------+-----+---------+----------------+
| id            | int(11)      | NO   | PRI | NULL    | auto_increment |
| name          | varchar(255) | YES  |     | NULL    |                |
| prefecture    | varchar(255) | YES  |     | NULL    |                |
| created_at    | datetime     | YES  |     | NULL    |                |
| updated_at    | datetime     | YES  |     | NULL    |                |
+---------------+--------------+------+-----+---------+----------------+
7 rows in set (0.00 sec)

mysql&gt;
</code></pre>

<p>みたいなものがあってView側で</p>

<pre><code>    @prefecture_name = People.group(:prefecture)
</code></pre>

<p>みたいな感じでprefectureをまとめておいて<br/>
プルダウンでprefectureを選択してsubmitして</p>

<pre><code>    &lt;%= form_tag({:action=&gt;"list"}, {:method=&gt;"get"}) do %&gt;
      # all_peoplesはpeoples
      &lt;%= select_tag 'prefecture', options_from_collection_for_select(@prefecture_name, "prefecture", "prefecture") %&gt;
      &lt;%= submit_tag 'subsubsub' %&gt;
    &lt;% end %&gt;
</code></pre>

<p>で<code>prefecture</code>を<code>params</code>で受け取れるようにしておいて</p>

<pre><code>  def list
    @people_selected_by_prefecture = People.where(prefecture: params[:prefecture])
  end
</code></pre>

<p>みたいな感じでControllerで選択されたprefectureでレコードを抜いておいて</p>

<pre><code>&lt;% @people_selected_by_prefecture.each do |p| %&gt;
  &lt;%= p.name %&gt; | &lt;%= p.prefecture %&gt;&lt;br&gt;
&lt;% end %&gt;
</code></pre>

<p>みたいな感じでプルダウンで選んだprefectureに該当する人間を選ぶ<br/>
みたいな感じ</p>

<pre><code>&lt;% @people_selected_by_prefecture.each do |p| %&gt;
  &lt;%= p[0] %&gt; | &lt;%= p[1] %&gt;&lt;br&gt;
&lt;% end %&gt;
</code></pre>

<p>とかでやろうとしていたけどそもそもHashではない</p>
]]></content>
  </entry>
  
</feed>

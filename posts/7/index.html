
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>さよならインターネット</title>
  <meta name="author" content="kenjiskywalker">

  
  <meta name="description" content="基本にカエル英語の本 英文法入門 レベル1著者 : 石崎秀穂スリーエーネットワーク発売日 : 2007-07ブクログでレビューを見る» 基本にカエル英語の本 英文法入門 レベル2著者 : 石崎秀穂スリーエーネットワーク発売日 : 2007-09ブクログでレビューを見る» 基本にカエル英語の本 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.kenjiskywalker.org/posts/7/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="さよならインターネット" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37377904-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">さよならインターネット</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.kenjiskywalker.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Goodbye The Internet.</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/15/201402-book/">2014/02読んだ本</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-15T21:00:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E5%9F%BA%E6%9C%AC%E3%81%AB%E3%82%AB%E3%82%A8%E3%83%AB%E8%8B%B1%E8%AA%9E%E3%81%AE%E6%9C%AC-%E8%8B%B1%E6%96%87%E6%B3%95%E5%85%A5%E9%96%80-%E3%83%AC%E3%83%99%E3%83%AB1-%E7%9F%B3%E5%B4%8E-%E7%A7%80%E7%A9%82/dp/4883194280%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4883194280" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51eRw7Xha8L._SL160_.jpg" width="104" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E5%9F%BA%E6%9C%AC%E3%81%AB%E3%82%AB%E3%82%A8%E3%83%AB%E8%8B%B1%E8%AA%9E%E3%81%AE%E6%9C%AC-%E8%8B%B1%E6%96%87%E6%B3%95%E5%85%A5%E9%96%80-%E3%83%AC%E3%83%99%E3%83%AB1-%E7%9F%B3%E5%B4%8E-%E7%A7%80%E7%A9%82/dp/4883194280%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4883194280" target="_blank">基本にカエル英語の本 英文法入門 レベル1</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E7%9F%B3%E5%B4%8E%E7%A7%80%E7%A9%82" target="_blank">石崎秀穂</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">スリーエーネットワーク</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2007-07</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/4883194280" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>




<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E5%9F%BA%E6%9C%AC%E3%81%AB%E3%82%AB%E3%82%A8%E3%83%AB%E8%8B%B1%E8%AA%9E%E3%81%AE%E6%9C%AC-%E8%8B%B1%E6%96%87%E6%B3%95%E5%85%A5%E9%96%80-%E3%83%AC%E3%83%99%E3%83%AB2-%E7%9F%B3%E5%B4%8E-%E7%A7%80%E7%A9%82/dp/4883194299%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4883194299" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51BNO%2B%2BCijL._SL160_.jpg" width="105" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E5%9F%BA%E6%9C%AC%E3%81%AB%E3%82%AB%E3%82%A8%E3%83%AB%E8%8B%B1%E8%AA%9E%E3%81%AE%E6%9C%AC-%E8%8B%B1%E6%96%87%E6%B3%95%E5%85%A5%E9%96%80-%E3%83%AC%E3%83%99%E3%83%AB2-%E7%9F%B3%E5%B4%8E-%E7%A7%80%E7%A9%82/dp/4883194299%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4883194299" target="_blank">基本にカエル英語の本 英文法入門 レベル2</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E7%9F%B3%E5%B4%8E%E7%A7%80%E7%A9%82" target="_blank">石崎秀穂</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">スリーエーネットワーク</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2007-09</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/4883194299" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>




<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E5%9F%BA%E6%9C%AC%E3%81%AB%E3%82%AB%E3%82%A8%E3%83%AB%E8%8B%B1%E8%AA%9E%E3%81%AE%E6%9C%AC-%E8%8B%B1%E6%96%87%E6%B3%95%E5%85%A5%E9%96%80-%E3%83%AC%E3%83%99%E3%83%AB3-%E7%9F%B3%E5%B4%8E-%E7%A7%80%E7%A9%82/dp/4883194302%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4883194302" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51Fo8Uu0GNL._SL160_.jpg" width="105" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E5%9F%BA%E6%9C%AC%E3%81%AB%E3%82%AB%E3%82%A8%E3%83%AB%E8%8B%B1%E8%AA%9E%E3%81%AE%E6%9C%AC-%E8%8B%B1%E6%96%87%E6%B3%95%E5%85%A5%E9%96%80-%E3%83%AC%E3%83%99%E3%83%AB3-%E7%9F%B3%E5%B4%8E-%E7%A7%80%E7%A9%82/dp/4883194302%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D4883194302" target="_blank">基本にカエル英語の本 英文法入門 レベル3</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E7%9F%B3%E5%B4%8E%E7%A7%80%E7%A9%82" target="_blank">石崎秀穂</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">スリーエーネットワーク</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2007-10</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/4883194302" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>




<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E7%A7%81%E6%9C%AC%E5%A4%AA%E5%B9%B3%E8%A8%98-01-%E3%81%82%E3%81%97%E3%81%8B%E3%81%8C%E5%B8%96-%E5%90%89%E5%B7%9D-%E8%8B%B1%E6%B2%BB-ebook/dp/B00G3QMEZY%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00G3QMEZY" target="_blank"><img src="http://ecx.images-amazon.com/images/I/51b6JBk8CcL._SL160_.jpg" width="100" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E7%A7%81%E6%9C%AC%E5%A4%AA%E5%B9%B3%E8%A8%98-01-%E3%81%82%E3%81%97%E3%81%8B%E3%81%8C%E5%B8%96-%E5%90%89%E5%B7%9D-%E8%8B%B1%E6%B2%BB-ebook/dp/B00G3QMEZY%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00G3QMEZY" target="_blank">私本太平記 01 あしかが帖</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E5%90%89%E5%B7%9D%E8%8B%B1%E6%B2%BB" target="_blank">吉川英治</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em"></div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2013-10-22</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/B00G3QMEZY" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/14/hatena-lunch/">はてなの東京オフィスに美味しいランチをたべさせてもらいに行ってきた</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-14T00:41:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="http://i.gyazo.com/336367bb2a59faf168c19be50f73550f.png" alt="http://i.gyazo.com/336367bb2a59faf168c19be50f73550f.png" /></p>

<p>エントランスがスタイリッシュ</p>

<p><img src="http://i.gyazo.com/52f29e4701ec70b36c206d837c297f88.png" alt="http://i.gyazo.com/52f29e4701ec70b36c206d837c297f88.png" /></p>

<p>めちゃうま健康ランチ</p>

<hr />

<p>経緯</p>

<blockquote class="twitter-tweet" lang="en"><p><a href="https://twitter.com/kenjiskywalker">@kenjiskywalker</a> 是非どうぞ！</p>&mdash; Shinji Tanaka (@stanaka) <a href="https://twitter.com/stanaka/statuses/413163134078029825">December 18, 2013</a></blockquote>


<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>stanakaさんにOKを頂いたのが去年の12月で<br/>
色々モジモジしたりしていて、行きたいな〜行ってもいいのかな〜<br/>
とモジモジしており、モジモジしてても仕方ない<br/>
連絡しよう！と思ったのが火曜日の夜で、京都には何人か知り合いの人がいるけど<br/>
東京オフィスはどの人を頼ったらいいんだ&hellip;<br/>
と悩んだ挙句、お問い合わせフォームから連絡しました。</p>

<p>これが色々とお手数をおかけしてしまったらしく<br/>
気軽に誰かに声かけた方がよかったらしいので、これを読まれている識者の方々は<br/>
オフィスへ遊びに行くときはまず知り合いの人を頼って連絡しましょう。</p>

<p>id:tomomiiさんからご連絡頂き、木曜日のランチにお邪魔させて頂きました。<br/>
id:onishiさんにご対応頂いてしまって本当に申し訳なかったでした。<br/>
今週末行われる</p>

<ul>
<li><a href="http://dev.classmethod.jp/cloud/aws/jaws-days-2014-immutable-infrastructure/">JAWS DAYS 2014Immutable Infrastructure Track</a></li>
</ul>


<p>のパネルディスカッションのモデレーターと、今月末に行われる超満員の</p>

<ul>
<li><a href="http://atnd.org/events/47786">Immutable Infrastructure Conference #1</a></li>
</ul>


<p>を開催される神様のid:stanakaさんもいらっしゃって、<br/>
サマリーメンバーもなかなかの緊張感を持ったお昼でした。</p>

<p>突然の訪問にも関わらず、カンバン方式での開発態勢や<br/>
デザイナーとエンジニアの仕事の進め方など色々お話しすることができて<br/>
ともて有り難かったです。</p>

<p>ご飯も健康的で美味しくて、最近毎日のように学食ばかり食べている我々にとっては<br/>
最高の昼食でありました。ごちそうさまでした。美味しかったです。</p>

<p>次にお伺いするときはもうちょっと余裕を持って遊びに行けるようにします。<br/>
お邪魔させて頂きありがとうございました。</p>

<p>はてなさんでは<a href="http://hatenacorp.jp/recruit/career/sp-application-engineer">iOSエンジニアを募集中</a>とのことでした。<br/>
美味しいお昼ごはんが食べられるので<br/>
美味しいお昼ごはんが食べたい人は応募してみると良さそうです。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/12/redis-2-8-sentinel-split-brain/">Redisの2.8.2からsplit Brainの対策がされているようです</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-12T01:46:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>2.8.2 [FIX] Sentinel better desynchronization to avoid split-brain elections
<a href="https://github.com/antirez/redis/blob/2.8/00-RELEASENOTES#L149">https://github.com/antirez/redis/blob/2.8/00-RELEASENOTES#L149</a></p>

<p>Sentinel: better time desynchronization.
<a href="https://github.com/antirez/redis/commit/75347ada7f431925b97b037b56b5e3801e3fd16d">https://github.com/antirez/redis/commit/75347ada7f431925b97b037b56b5e3801e3fd16d</a></p>

<blockquote><p>Sentinels are now desynchronized in a better way changing the time
handler frequency between 10 and 20 HZ. This way on average a
desynchronization of 25 milliesconds is produced that should be larger
enough compared to network latency, avoiding most split-brain condition
during the vote.</p>

<p>Now that the clocks are desynchronized, to have larger random delays when
performing operations can be easily achieved in the following way.
Take as example the function that starts the failover, that is
called with a frequency between 10 and 20 HZ and will start the
failover every time there are the conditions. By just adding as an
additional condition something like rand()%4 == 0, we can amplify the
desynchronization between Sentinel instances easily.</p></blockquote>

<p>こちらからは以上です。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/01/zen-cha-hannya/">禅、写経、茶の湯</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-01T17:01:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>テレビでお坊さんが、写経をすることで別世界へ行くことができる。<br/>
言葉を永遠と写すことで精神の深いところへたどり着ける。<br/>
という話をされていた。</p>

<p>禅と瞑想も同じで、今日気になっていた茶の湯の本読んでいたら<br/>
決められた動作を静かに正確に行うことによって、精神の深いところへたどり着ける。<br/>
って書いてあって、昔から市中の山居なんて言葉もあったことだし<br/>
当時の人もまた、色々と忙しかったり表層的な事象にやんや悩んだりしていたんだろう。</p>

<p>禅、写経、茶の湯、全部のルーツは心の再生というか<br/>
深いところまで潜っていく浄化作用というか、そういうものがあったのではないかと<br/>
ふと考えた。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/24/ec2-start-raid0-script/">EC2のインスタンスが立ち上がってきた時にEphemeral Diskを束ねてRAID0にするスクリプト</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-24T18:15:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ephemeral Diskが8本ある場合は条件を増やせば良い。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'>
</span><span class='line'>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/opt/aws/bin:/usr/local/bin
</span><span class='line'>
</span><span class='line'>if [[ \`test -e /dev/xvdc ; echo \$?\` -eq 0 ]] ; then
</span><span class='line'>    if [[ \`test -e /dev/xvde ; echo \$?\` -eq 0 ]] ; then
</span><span class='line'>
</span><span class='line'>        # RAID用のファイルをつくる(ephemeral x4バージョン)
</span><span class='line'>        umount /media/ephemeral0
</span><span class='line'>        yes | mdadm --create /dev/md127 --level=0 --raid-devices=4 /dev/xvd[bcde]
</span><span class='line'>        mkfs.ext4 /dev/md127
</span><span class='line'>        mount /dev/md127 /media/ephemeral0
</span><span class='line'>    else
</span><span class='line'>
</span><span class='line'>        # RAID用のファイルをつくる(ephemeral x2バージョン)
</span><span class='line'>        umount /media/ephemeral0
</span><span class='line'>        yes | mdadm --create /dev/md127 --level=0 --raid-devices=2 /dev/xvd[bc]
</span><span class='line'>        mkfs.ext4 /dev/md127
</span><span class='line'>        mount /dev/md127 /media/ephemeral0
</span><span class='line'>    fi
</span><span class='line'>fi</span></code></pre></td></tr></table></div></figure>


<p>このスクリプトを<code>rc.local</code>とか<code>/etc/rc3.d/S~</code>とかに置いておけば<br/>
起動時にRAID0として束ねて立ち上がってくれる。</p>

<blockquote><p>このクールなアイデアは自分発のものではない</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/24/var-lock-subsys/">/var/lock/subsys/について</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-24T17:49:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>init.dスクリプトの中に<code>/var/lock/subsys/</code>という文字列を見たことはあったが<br/>
何をしているのかまで追ったことはなかった。</p>

<ul>
<li><a href="http://d.hatena.ne.jp/higher_tomorrow/20110421/1303337554">（今さら）Linuxでサービスを登録する - あしのあしあと</a></li>
</ul>


<p>こちらのページに大切なことは全て書いてあった。ありがたい。<br/>
「インスタンス起動時にRoute53でゴニョゴニョして、<br/>
インスタンス終了時にゴニョゴニョしたい」<br/>
という機能を実装するのに、init scriptを作成するのはよくあることだと思う。<br/>
その際、stopが上手く動かなく、その原因が<code>/var/lock/subsys/</code>であったので<br/>
備忘録として記録しておく。</p>

<ul>
<li>/etc/init/rc.conf</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># rc - System V runlevel compatibility
</span><span class='line'>#
</span><span class='line'># This task runs the old sysv-rc runlevel scripts.  It
</span><span class='line'># is usually started by the telinit compatibility wrapper.
</span><span class='line'>#
</span><span class='line'># Do not edit this file directly. If you want to change the behaviour,
</span><span class='line'># please create a file rc.override and put your changes there.
</span><span class='line'>
</span><span class='line'>start on runlevel [0123456]
</span><span class='line'>
</span><span class='line'>stop on runlevel [!$RUNLEVEL]
</span><span class='line'>
</span><span class='line'>task
</span><span class='line'>
</span><span class='line'>export RUNLEVEL
</span><span class='line'>console output
</span><span class='line'>exec /etc/rc.d/rc $RUNLEVEL</span></code></pre></td></tr></table></div></figure>


<ul>
<li>/etc/rc.d/rc</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#! /bin/bash
</span><span class='line'>#
</span><span class='line'># rc            This file is responsible for starting/stopping
</span><span class='line'>#               services when the runlevel changes.
</span><span class='line'>#
</span><span class='line'># Original Author:
</span><span class='line'>#               Miquel van Smoorenburg, &lt;miquels@drinkel.nl.mugnet.org&gt;
</span><span class='line'>#
</span><span class='line'>
</span><span class='line'>... 
</span><span class='line'>
</span><span class='line'># First, run the KILL scripts.
</span><span class='line'>for i in /etc/rc$runlevel.d/K* ; do
</span><span class='line'>
</span><span class='line'>        # Check if the subsystem is already up.
</span><span class='line'>        subsys=${i#/etc/rc$runlevel.d/K??}
</span><span class='line'>        [ -f /var/lock/subsys/$subsys -o -f /var/lock/subsys/$subsys.init ] || continue
</span><span class='line'>        check_runlevel "$i" || continue
</span><span class='line'>
</span><span class='line'>        # Bring the subsystem down.
</span><span class='line'>        [ -n "$UPSTART" ] && initctl emit --quiet stopping JOB=$subsys
</span><span class='line'>        $i stop
</span><span class='line'>        [ -n "$UPSTART" ] && initctl emit --quiet stopped JOB=$subsys
</span><span class='line'>done
</span><span class='line'>
</span><span class='line'># Now run the START scripts.
</span><span class='line'>for i in /etc/rc$runlevel.d/S* ; do
</span><span class='line'>
</span><span class='line'>        # Check if the subsystem is already up.
</span><span class='line'>        subsys=${i#/etc/rc$runlevel.d/S??}
</span><span class='line'>        [ -f /var/lock/subsys/$subsys ] && continue
</span><span class='line'>        [ -f /var/lock/subsys/$subsys.init ] && continue
</span><span class='line'>        check_runlevel "$i" || continue
</span><span class='line'>
</span><span class='line'>        # If we're in confirmation mode, get user confirmation
</span><span class='line'>        if [ "$do_confirm" = "yes" ]; then
</span><span class='line'>                confirm $subsys
</span><span class='line'>                rc=$?
</span><span class='line'>                if [ "$rc" = "1" ]; then
</span><span class='line'>                        continue
</span><span class='line'>                elif [ "$rc" = "2" ]; then
</span><span class='line'>                        do_confirm="no"
</span><span class='line'>                fi
</span><span class='line'>        fi
</span><span class='line'>
</span><span class='line'>        update_boot_stage "$subsys"
</span><span class='line'>        # Bring the subsystem up.
</span><span class='line'>        [ -n "$UPSTART" ] && initctl emit --quiet starting JOB=$subsys
</span><span class='line'>        if [ "$subsys" = "halt" -o "$subsys" = "reboot" ]; then
</span><span class='line'>                export LC_ALL=C
</span><span class='line'>                exec $i start
</span><span class='line'>        fi
</span><span class='line'>        $i start
</span><span class='line'>        [ -n "$UPSTART" ] && initctl emit --quiet started JOB=$subsys
</span><span class='line'>done
</span><span class='line'>[ "$do_confirm" = "yes" ] && rm -f /var/run/confirm
</span><span class='line'>exit 0</span></code></pre></td></tr></table></div></figure>


<p>ということで</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    [ -f /var/lock/subsys/$subsys -o -f /var/lock/subsys/$subsys.init ] || continue</span></code></pre></td></tr></table></div></figure>


<p>この条件を満たさなければ<code>stop</code>が発動しないことがわかった。<br/>
nginxのinit scriptでも</p>

<ul>
<li><a href="http://wiki.nginx.org/RedHatNginxInitScript">RedHatNginxInitScript</a></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>lockfile=/var/lock/subsys/nginx
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>start()
</span><span class='line'>{
</span><span class='line'>    [ $retval -eq 0 ] && touch $lockfile
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'>stop()
</span><span class='line'>{
</span><span class='line'>    [ $retval -eq 0 ] && rm -f $lockfile
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>としてstart、stop時にlockfileを操作している。</p>

<p>自分の独自スクリプトを作成する場合は</p>

<ul>
<li>/etc/init.d/hoge-script</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/sh
</span><span class='line'>#
</span><span class='line'># hoge-script
</span><span class='line'>#
</span><span class='line'># chkconfig: 2345 20 01
</span><span class='line'># description: hoge-script shell
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>lock_file="/var/lock/subsys/hoge-script"
</span><span class='line'>
</span><span class='line'>start()
</span><span class='line'>{
</span><span class='line'>    # lock_fileを生成しないとshutdownの時に実行されない
</span><span class='line'>    touch ${lock_file}
</span><span class='line'>
</span><span class='line'>    # 処理 
</span><span class='line'>
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>stop()
</span><span class='line'>{
</span><span class='line'>    # lock_fileの削除
</span><span class='line'>    rm -r ${lock_file}
</span><span class='line'>
</span><span class='line'>    # 処理
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>case "$1" in
</span><span class='line'>    start)
</span><span class='line'>        start
</span><span class='line'>    ;;
</span><span class='line'>    stop)
</span><span class='line'>        stop
</span><span class='line'>    ;;
</span><span class='line'>    *)
</span><span class='line'>        echo "Usage: $0 {start|stop}"
</span><span class='line'>    ;;
</span><span class='line'>esac
</span><span class='line'>
</span><span class='line'>exit 0</span></code></pre></td></tr></table></div></figure>


<p>のように作成するとstart/stopの処理が正常に動く。<br/>
こういう事象に出くわすと自分の知識がいかに御座なりかわかる。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/11/201401-book/">2014/01読んだ本</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-11T11:29:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="https://twitter.com/nakashii_">@nakashii_</a>さんから借りた「宗教で読む戦国時代」が面白かった。<br/>
坊さんが演説する時に三千人ぐらい集まってたり、<br/>
普通の農民が宣教師と宗教論語ったりするというのがすごかった。<br/>
あと３回ぐらい読み直したい。</p>

<p>技術書読む為に中学生の英文法を勉強していることもあってなかなか吸収が少ない。<br/>
吸収が少ないとはいえ、キングダムが無茶苦茶面白かった。</p>

<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E5%AE%97%E6%95%99%E3%81%A7%E8%AA%AD%E3%82%80%E6%88%A6%E5%9B%BD%E6%99%82%E4%BB%A3-%E8%AC%9B%E8%AB%87%E7%A4%BE%E9%81%B8%E6%9B%B8%E3%83%A1%E3%83%81%E3%82%A8-%E7%A5%9E%E7%94%B0%E5%8D%83%E9%87%8C-ebook/dp/B00E3MZYLQ%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00E3MZYLQ" target="_blank"><img src="http://ecx.images-amazon.com/images/I/41-aZEFUMVL._SL160_.jpg" width="103" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E5%AE%97%E6%95%99%E3%81%A7%E8%AA%AD%E3%82%80%E6%88%A6%E5%9B%BD%E6%99%82%E4%BB%A3-%E8%AC%9B%E8%AB%87%E7%A4%BE%E9%81%B8%E6%9B%B8%E3%83%A1%E3%83%81%E3%82%A8-%E7%A5%9E%E7%94%B0%E5%8D%83%E9%87%8C-ebook/dp/B00E3MZYLQ%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00E3MZYLQ" target="_blank">宗教で読む戦国時代 (講談社選書メチエ)</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E7%A5%9E%E7%94%B0%E5%8D%83%E9%87%8C" target="_blank">神田千里</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">講談社</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2010-02-10</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/B00E3MZYLQ" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>




<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E4%B8%80%E5%80%8B%E4%BA%BA-%E3%81%84%E3%81%A3%E3%81%93%E3%81%98%E3%82%93-2014%E5%B9%B4-02%E6%9C%88%E5%8F%B7-%E9%9B%91%E8%AA%8C/dp/B00H4FJS4I%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00H4FJS4I" target="_blank"><img src="http://ecx.images-amazon.com/images/I/61YHNzTuEZL._SL160_.jpg" width="107" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E4%B8%80%E5%80%8B%E4%BA%BA-%E3%81%84%E3%81%A3%E3%81%93%E3%81%98%E3%82%93-2014%E5%B9%B4-02%E6%9C%88%E5%8F%B7-%E9%9B%91%E8%AA%8C/dp/B00H4FJS4I%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00H4FJS4I" target="_blank">一個人 (いっこじん) 2014年 02月号 [雑誌]</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : </div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">ベストセラーズ</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2013-12-26</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/B00H4FJS4I" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>




<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/%E3%82%AD%E3%83%B3%E3%82%B0%E3%83%80%E3%83%A0-32-%E3%83%A4%E3%83%B3%E3%82%B0%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%97%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9DIGITAL-%E5%8E%9F%E6%B3%B0%E4%B9%85-ebook/dp/B00HFU3WQM%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00HFU3WQM" target="_blank"><img src="http://ecx.images-amazon.com/images/I/614cpMvHbFL._SL160_.jpg" width="120" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/%E3%82%AD%E3%83%B3%E3%82%B0%E3%83%80%E3%83%A0-32-%E3%83%A4%E3%83%B3%E3%82%B0%E3%82%B8%E3%83%A3%E3%83%B3%E3%83%97%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF%E3%82%B9DIGITAL-%E5%8E%9F%E6%B3%B0%E4%B9%85-ebook/dp/B00HFU3WQM%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB00HFU3WQM" target="_blank">キングダム 32 (ヤングジャンプコミックスDIGITAL)</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E5%8E%9F%E6%B3%B0%E4%B9%85" target="_blank">原泰久</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">集英社</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2013-10-18</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/B00HFU3WQM" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>




<div class="booklog_html"><table><tr><td class="booklog_html_image"><a href="http://www.amazon.co.jp/GIANT-KILLING-30-%E3%83%A2%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0KC-%E3%83%84%E3%82%B8%E3%83%88%E3%83%A2/dp/406387284X%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D406387284X" target="_blank"><img src="http://ecx.images-amazon.com/images/I/618fqUkk0kL._SL160_.jpg" width="105" height="150" style="border:0;border-radius:0;" /></a></td><td class="booklog_html_info" style="padding-left:20px;"><div class="booklog_html_title" style="margin-bottom:10px;font-size:14px;font-weight:bold;"><a href="http://www.amazon.co.jp/GIANT-KILLING-30-%E3%83%A2%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0KC-%E3%83%84%E3%82%B8%E3%83%88%E3%83%A2/dp/406387284X%3FSubscriptionId%3D0AVSM5SVKRWTFMG7ZR82%26tag%3D13nightcrows-22%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3D406387284X" target="_blank">GIANT KILLING(30) (モーニングKC)</a></div><div style="margin-bottom:10px;"><div class="booklog_html_author" style="margin-bottom:15px;font-size:12px;;line-height:1.2em">著者 : <a href="http://booklog.jp/author/%E3%83%84%E3%82%B8%E3%83%88%E3%83%A2" target="_blank">ツジトモ</a></div><div class="booklog_html_manufacturer" style="margin-bottom:5px;font-size:12px;;line-height:1.2em">講談社</div><div class="booklog_html_release" style="font-size:12px;;line-height:1.2em">発売日 : 2014-01-23</div></div><div class="booklog_html_link_amazon"><a href="http://booklog.jp/item/1/406387284X" style="font-size:12px;" target="_blank">ブクログでレビューを見る»</a></div></td></tr></table></div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/05/about-smtp/">SMTPが何故嫌いか</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-05T18:04:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>雑談です。</p>

<ul>
<li>送り先を間違えると二度と取り戻せない(メールサーバを管理している場合を除く)</li>
<li>そのSMTPのトラフィックの半分以上はスパム(<a href="http://www.securelist.com/en/analysis/204792322/Kaspersky_Security_Bulletin_Spam_evolution_2013">Kaspersky Security Bulletin. Spam evolution 2013</a>)</li>
</ul>


<p>送り先を間違えると二度と取り戻せないのは、人間に対して厳しい仕様ではないのかなと。<br/>
万が一間違えた場合、インターネットは無力なことが多くて<br/>
該当のメールを削除してくださいと電話したり、メール誤送信についてのFAXを送ったりする。</p>

<p>インターネットでは物騒が当たり前なようですが、大半がSPAMのトラフィックを捌く方も大変ですね。</p>

<p>で、どうしたら良いって話なんですが<br/>
メールアドレスじゃなくてhash値生成してそこのURLへアクセスすると <br/>
メッセージが見れてやり取りができる。万が一内容を間違えた場合は<br/>
誤った内容のメッセージを削除して再生成する。とかが良いのかなと。</p>

<p>そしてそのURLをどうやって送るかっていうとSMT(この文章はここで終わっている)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/02/2014-02-movie/">「ワールド・ウォーZ」と「ニュー・ジャック・シティ」見た</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-02T23:18:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><iframe src="https://banners.itunes.apple.com/banner.html?partnerId=&aId=11ldGT&id=756496633&c=jp&l=ja-JP&bt=catalog&t=catalog_black&w=300&h=250" frameborder=0 style="overflow-x:hidden;overflow-y:hidden;width:300px;height:250px;border:0px"></iframe>


<p>意外に面白かった。</p>

<iframe src="https://banners.itunes.apple.com/banner.html?partnerId=&aId=11ldGT&id=718046714&c=jp&l=ja-JP&bt=catalog&t=catalog_black&w=300&h=250" frameborder=0 style="overflow-x:hidden;overflow-y:hidden;width:300px;height:250px;border:0px"></iframe>


<p>今の原宿にいる女の子の服装こんな感じだった。<br/>
なんだかんだでこのジャケットが一番おもしろいと思う。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/02/02/ups-omron-nut/">Ubuntu 13.10でOMRONのUPS BY35Sを使う</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-02T11:53:00+09:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>Ubuntu 13.04
nut        2.6.4-2.2ubuntu1<br/>
nut-client 2.6.4-2.2ubuntu1<br/>
nut-server 2.6.4-2.2ubuntu1</p></blockquote>

<p><a href="http://www.amazon.co.jp/gp/product/B002UQFAPW/ref=as_li_ss_il?ie=UTF8&camp=247&creative=7399&creativeASIN=B002UQFAPW&linkCode=as2&tag=13nightcrows-22"><img border="0" src="http://ws-fe.amazon-adsystem.com/widgets/q?_encoding=UTF8&ASIN=B002UQFAPW&Format=_SL110_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=13nightcrows-22" ></a><img src="http://ir-jp.amazon-adsystem.com/e/ir?t=13nightcrows-22&l=as2&o=9&a=B002UQFAPW" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" /></p>

<p><a href="http://d.hatena.ne.jp/sfujiwara/20110216/1297867818">OMRON の UPS BY35S を Linux と使う - 酒日記はてな支店</a></p>

<p>家のブレーカーがバシバシ落ちるのでfujiwaraさんおすすめのUPSを買った。<br/>
SSSを使いたかったけどDebian系はフォローしてなかったので<a href="http://www.networkupstools.org/">Network UPS Tools</a>を利用した。</p>

<h3>設定参考</h3>

<p><a href="http://sunnyone41.blogspot.jp/2011/05/omron-by50subuntu-1104.html">OMRON BY50SをUbuntu 11.04で使用する</a><br/>
<a href="http://srackham.wordpress.com/2013/02/27/configuring-nut-for-the-eaton-3s-ups-on-ubuntu-linux/">Configuring NUT for the Eaton 3S UPS on Ubuntu Linux</a></p>

<h3>作業内容</h3>

<ol>
<li>BY35Sの電源入れる</li>
<li>BY35Sからサーバの電源を取る</li>
<li>BY35SとサーバをUSBでつなぐ。</li>
</ol>


<h4>サーバにて</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># apt-get install nut</span></code></pre></td></tr></table></div></figure>


<p>nut-clientとnut-serverがインストールされる。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ lsusb | grep -i omron
</span><span class='line'>Bus 002 Device 006: ID 0590:0080 Omron Corp.
</span><span class='line'>$
</span><span class='line'>$ lsusb -v -s 002:006
</span><span class='line'>
</span><span class='line'>Bus 002 Device 006: ID 0590:0080 Omron Corp.
</span><span class='line'>Couldn't open device, some information will be missing
</span><span class='line'>Device Descriptor:
</span><span class='line'>  bLength                18
</span><span class='line'>  bDescriptorType         1
</span><span class='line'>  bcdUSB               1.10
</span><span class='line'>  bDeviceClass            0 (Defined at Interface level)
</span><span class='line'>  bDeviceSubClass         0
</span><span class='line'>  bDeviceProtocol         0
</span><span class='line'>  bMaxPacketSize0         8
</span><span class='line'>  idVendor           0x0590 Omron Corp.
</span><span class='line'>  idProduct          0x0080
</span><span class='line'>  bcdDevice            1.08
</span><span class='line'>  iManufacturer           3
</span><span class='line'>  iProduct                1
</span><span class='line'>  iSerial                 0
</span><span class='line'>  bNumConfigurations      1
</span><span class='line'>  Configuration Descriptor:
</span><span class='line'>    bLength                 9
</span><span class='line'>    bDescriptorType         2
</span><span class='line'>    wTotalLength           34
</span><span class='line'>    bNumInterfaces          1
</span><span class='line'>    bConfigurationValue     1
</span><span class='line'>    iConfiguration          0
</span><span class='line'>    bmAttributes         0xe0
</span><span class='line'>      Self Powered
</span><span class='line'>      Remote Wakeup
</span><span class='line'>    MaxPower              100mA
</span><span class='line'>    Interface Descriptor:
</span><span class='line'>      bLength                 9
</span><span class='line'>      bDescriptorType         4
</span><span class='line'>      bInterfaceNumber        0
</span><span class='line'>      bAlternateSetting       0
</span><span class='line'>      bNumEndpoints           1
</span><span class='line'>      bInterfaceClass         3 Human Interface Device
</span><span class='line'>      bInterfaceSubClass      0 No Subclass
</span><span class='line'>      bInterfaceProtocol      0 None
</span><span class='line'>      iInterface              0
</span><span class='line'>        HID Device Descriptor:
</span><span class='line'>          bLength                 9
</span><span class='line'>          bDescriptorType        33
</span><span class='line'>          bcdHID               1.11
</span><span class='line'>          bCountryCode            0 Not supported
</span><span class='line'>          bNumDescriptors         1
</span><span class='line'>          bDescriptorType        34 Report
</span><span class='line'>          wDescriptorLength      27
</span><span class='line'>         Report Descriptors:
</span><span class='line'>           ** UNAVAILABLE **
</span><span class='line'>      Endpoint Descriptor:
</span><span class='line'>        bLength                 7
</span><span class='line'>        bDescriptorType         5
</span><span class='line'>        bEndpointAddress     0x81  EP 1 IN
</span><span class='line'>        bmAttributes            3
</span><span class='line'>          Transfer Type            Interrupt
</span><span class='line'>          Synch Type               None
</span><span class='line'>          Usage Type               Data
</span><span class='line'>        wMaxPacketSize     0x0008  1x 8 bytes
</span><span class='line'>        bInterval              10
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure>


<p>idVendorとidProductをメモしておく</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># diff -C0 /lib/udev/rules.d/.52-nut-usbups.rules /lib/udev/rules.d/52-nut-usbups.rules
</span><span class='line'>*** /lib/udev/rules.d/.52-nut-usbups.rules      2014-02-01 22:23:17.624993312 +0900
</span><span class='line'>--- /lib/udev/rules.d/52-nut-usbups.rules       2014-02-02 00:27:37.540750650 +0900
</span><span class='line'>***************
</span><span class='line'>*** 205 ****
</span><span class='line'>--- 206,208 ----
</span><span class='line'>+ # omron UPS BY35S - blazer_usb
</span><span class='line'>+ ATTR{idVendor}=="0590", ATTR{idProduct}=="0080", MODE="664", GROUP="nut"
</span><span class='line'>+</span></code></pre></td></tr></table></div></figure>


<p>メモした内容を<code>/lib/udev/rules.d/52-nut-usbups.rules</code>に追記する。</p>

<h4>nut.conf</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>MODE=standalone</span></code></pre></td></tr></table></div></figure>


<h4>ups.conf</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[ups]
</span><span class='line'>     driver    = blazer_usb
</span><span class='line'>     port      = auto
</span><span class='line'>     vendorid  = 0590
</span><span class='line'>     productid = 0080
</span><span class='line'>     subdriver = ippon</span></code></pre></td></tr></table></div></figure>


<h4>upsd.users</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    [upsmon]
</span><span class='line'>            password  = pass
</span><span class='line'>            upsmon master</span></code></pre></td></tr></table></div></figure>


<h4>upsmon.conf</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>RUN_AS_USER root
</span><span class='line'>MONITOR ups@localhost 1 upsmon pass master
</span><span class='line'>MINSUPPLIES 1
</span><span class='line'>SHUTDOWNCMD "/sbin/shutdown -h +0"
</span><span class='line'>NOTIFYCMD "/etc/nut/notifycmd"
</span><span class='line'>POLLFREQ 5
</span><span class='line'>POLLFREQALERT 5
</span><span class='line'>HOSTSYNC 15
</span><span class='line'>DEADTIME 15
</span><span class='line'>POWERDOWNFLAG /etc/killpower
</span><span class='line'>NOTIFYFLAG ONLINE       SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG ONBATT       SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG LOWBATT      SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG FSD          SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG COMMOK       SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG COMMBAD      SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG SHUTDOWN     SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG REPLBATT     SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG NOCOMM       SYSLOG+WALL+EXEC
</span><span class='line'>NOTIFYFLAG NOPARENT     SYSLOG+WALL+EXEC
</span><span class='line'>RBWARNTIME 43200
</span><span class='line'>NOCOMMWARNTIME 300
</span><span class='line'>FINALDELAY 5</span></code></pre></td></tr></table></div></figure>


<h4>notifycmd</h4>

<p>vmのシャットダウンはfujiwaraさんのを丸コピ</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'>#
</span><span class='line'># NUT NOTIFYCMD script
</span><span class='line'>
</span><span class='line'>PATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/local/sbin:/usr/local/bin
</span><span class='line'>
</span><span class='line'>LANG=C
</span><span class='line'>export LANG
</span><span class='line'>
</span><span class='line'>trap "exit 0" SIGTERM
</span><span class='line'>
</span><span class='line'>if [ "$NOTIFYTYPE" = "ONLINE" ]
</span><span class='line'>then
</span><span class='line'>        echo $0: power restored | wall
</span><span class='line'>        # Cause all instances of this script to exit.
</span><span class='line'>        killall -s SIGTERM `basename $0`
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>if [ "$NOTIFYTYPE" = "ONBATT" ]
</span><span class='line'>then
</span><span class='line'>        echo $0: 5 minutes till system powers down... | wall
</span><span class='line'>        # Loop with one second interval to allow SIGTERM reception.
</span><span class='line'>        let "n = 300"
</span><span class='line'>        while [ $n -ne 0 ]
</span><span class='line'>        do
</span><span class='line'>                sleep 1
</span><span class='line'>                let "n--"
</span><span class='line'>        done
</span><span class='line'>
</span><span class='line'>        echo $0: vm shutdown | wall
</span><span class='line'>        VM=`/usr/bin/virsh list --all | grep 'running$' | awk '{print $2}'`
</span><span class='line'>        for v in $VM
</span><span class='line'>        do
</span><span class='line'>            echo $0: shutdown virtual machine $v | wall
</span><span class='line'>            virsh shutdown $v
</span><span class='line'>        done
</span><span class='line'>
</span><span class='line'>        echo $0: commencing shutdown | wall
</span><span class='line'>        upsmon -c fsd
</span><span class='line'>fi</span></code></pre></td></tr></table></div></figure>


<h4>nut start</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># /etc/init.d/nut-client start
</span><span class='line'># /etc/init.d/nut-server start
</span><span class='line'>#
</span><span class='line'># upsc ups
</span><span class='line'>battery.voltage: 13.50
</span><span class='line'>battery.voltage.high: -1.08
</span><span class='line'>battery.voltage.low: -0.87
</span><span class='line'>device.type: ups
</span><span class='line'>driver.name: blazer_usb
</span><span class='line'>driver.parameter.pollinterval: 2
</span><span class='line'>driver.parameter.port: auto
</span><span class='line'>driver.parameter.productid: 0080
</span><span class='line'>driver.parameter.subdriver: ippon
</span><span class='line'>driver.parameter.vendorid: 0590
</span><span class='line'>driver.version: 2.6.4
</span><span class='line'>driver.version.internal: 0.08
</span><span class='line'>input.frequency: 49.9
</span><span class='line'>input.voltage: 99.2
</span><span class='line'>input.voltage.fault: 99.2
</span><span class='line'>output.voltage: 98.9
</span><span class='line'>ups.beeper.status: disabled
</span><span class='line'>ups.delay.shutdown: 30
</span><span class='line'>ups.delay.start: 180
</span><span class='line'>ups.load: 29
</span><span class='line'>ups.productid: 0080
</span><span class='line'>ups.status: OL BYPASS
</span><span class='line'>ups.temperature: 37.5
</span><span class='line'>ups.type: offline / line interactive
</span><span class='line'>ups.vendorid: 0590
</span><span class='line'>#
</span><span class='line'>#
</span><span class='line'># upsc ups ups.status
</span><span class='line'>OL BYPASS
</span><span class='line'>#</span></code></pre></td></tr></table></div></figure>


<p>nut-serverも動かさないといけないのに気付かなくてハマってた。</p>

<ul>
<li>バッテリー状態にして5分後にシャットダウンが実行される</li>
<li>バッテリー状態にして商用電源を回復させてシャットダウンが停止される</li>
</ul>


<p>ことを確認した。これでブレーカーが落ちても取り敢えずは大丈夫。<br/>
ルーターとスイッチの電源もUPSから供給するようにしたら<br/>
ネット越しに通知を受け取れるけど配線とか配置とかやり直さないといけないので<br/>
元気があったらやりたい。元気があれば。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="8">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="6">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/12/14/immunity-of-change/">「なぜ人と組織は変われないのか」を読んだ</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/08/koukoku/">不快な広告と不快ではない広告</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/07/201411-book/">2014/11読んだ本</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/07/jyoen/">俺の子連れおすすめスポット - 新宿御苑</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/02/capistrano3-rails4-unicorn/">capistrano3を利用してRails4をdeployしunicornを使う</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/kenjiskywalker">@kenjiskywalker</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'kenjiskywalker',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - kenjiskywalker -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
